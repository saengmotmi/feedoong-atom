# PRD: Feedoong Solo

- 문서 버전: v0.2
- 작성일: 2026-02-21
- 제품 단계: MVP
- 대상: 1인 운영(개인 사용자 본인)

## 1. 문서 목적

이 문서는 "핵심 유저 스토리 기준 정상동작"을 먼저 정의하고,
그 정의를 기준으로 구현/테스트/배포 우선순위를 고정하기 위한 PRD다.

## 2. 문제 정의

기존 팀 기반 구조는 운영 인원/비용 대비 효율이 낮아 지속이 어려웠다.
하지만 핵심 가치(여러 RSS 피드를 한 화면에서 빠르게 소비)는 유효하다.

따라서 MVP는 다음에 집중한다.

1. 혼자서 유지 가능한 단순한 구조
2. 매일 실제로 쓸 수 있는 안정성
3. 코어 유저 스토리의 명확한 정상동작 기준

## 3. 핵심 유저 스토리

### US-01. 소스 등록

"나는 RSS URL을 등록하고, 등록 결과를 즉시 확인하고 싶다."

### US-02. 피드 소비

"나는 메인 화면에서 최신 글 목록을 보고, 원문 링크로 바로 이동하고 싶다."

### US-03. 수동 동기화

"나는 필요할 때 즉시 동기화를 눌러 최신 글을 반영하고 싶다."

### US-04. 자동 동기화

"나는 앱을 계속 붙잡고 있지 않아도 주기적으로 새 글이 반영되길 원한다."

### US-05. 기존 구독 마이그레이션 (v0.2)

"나는 과거에 모아둔 CSV 구독 목록을 한 번에 가져와서 시작하고 싶다."

## 4. 정상동작 정의 (핵심)

정상동작은 아래 4개 유저 스토리의 수용조건을 모두 만족하는 상태다.

### 4.1 US-01 소스 등록 정상동작

전제:
- API 프로세스 실행 중
- 사용자 입력 URL이 유효한 RSS URL

입력:
- 웹 폼에 URL 입력 후 "소스 등록" 제출

기대 결과:
1. API `POST /v1/sources`가 `201` 반환
2. 웹이 `/?status=source-added`로 리다이렉트
3. 화면에 "RSS 소스를 등록했습니다." 메시지 표시
4. "등록 소스" 목록 개수가 +1 증가

실패 동작(정의된 비정상):
- 중복 URL이면 `409` + 사용자에게 실패 상태(`source-error`) 표시

### 4.2 US-02 피드 소비 정상동작

전제:
- API 프로세스 실행 중
- 소스 0개 이상 존재

입력:
- `GET /` (웹 진입 또는 새로고침)

기대 결과:
1. 웹 응답 상태 `200`
2. 화면에 앱 타이틀(`Feedoong Solo`) 렌더링
3. API 에러 문구(`fetch failed`, `Network connection lost`)가 표시되지 않음
4. 아이템 목록은 최신순(publishedAt 우선, 없으면 createdAt)으로 표시
5. 각 아이템 클릭 시 원문 링크 새 탭 이동 가능

### 4.3 US-03 수동 동기화 정상동작

전제:
- API 실행 중
- 등록 소스 1개 이상

입력:
- "지금 동기화" 제출

기대 결과:
1. API `POST /v1/sync`가 `200`
2. 웹이 `/?status=synced`로 리다이렉트
3. 화면에 "동기화를 완료했습니다." 메시지 표시
4. 신규 글이 있으면 아이템 목록 수가 증가

실패 동작:
- 동기화 실패 시 `sync-error` 상태 표시

### 4.4 US-04 자동 동기화 정상동작

전제:
- scheduler 실행 중
- API 실행 중
- (선택) `SCHEDULER_KEY`가 API와 scheduler에 동일하게 설정

입력:
- cron 주기 도래 (`SYNC_CRON`)

기대 결과:
1. scheduler가 `POST /internal/sync` 호출
2. API가 인증 조건 충족 시 `200` 반환
3. 동기화 결과가 API 응답(JSON)으로 기록
4. 이후 웹 조회 시 신규 항목이 반영됨

### 4.5 US-05 기존 구독 마이그레이션 정상동작 (v0.2)

전제:
- API 실행 중
- CSV 파일에 `RSS 피드 URL` 헤더가 존재

입력:
- `yarn import:subscriptions [csv-path]`

기대 결과:
1. CSV의 유효 RSS URL 후보를 추출한다.
2. 중복 URL(동일 CSV 내/DB 내)을 제외한다.
3. API `POST /v1/sources` 호출 결과를 요약 출력한다.
4. 종료 로그에 `added`, `duplicate`, `failed` 카운트가 표시된다.

## 5. 현재 관측 상태 (2026-02-21 기준)

관측 결과:
1. API 건강 체크 `GET /health`는 `200` 응답
2. Web+API 동시 실행 시 웹 `GET /`는 `200`
3. API가 내려가 있으면 웹에 에러 문구가 표시됨
4. API가 올라오면 해당 에러 문구가 사라짐

판단:
- 최소 정상동작의 1차 조건(US-01/02의 기반인 API 연결성)은 충족 가능한 상태
- 자동동기화(US-04)는 별도 프로세스 실행/환경값 검증이 추가 필요

## 6. MVP 범위

### 6.1 포함

1. RSS 소스 등록/조회
2. 아이템 조회(최신순, limit/offset)
3. 수동 동기화
4. scheduler 기반 자동 동기화
5. 단일 사용자 기준 운영
6. CSV 기반 구독 목록 일괄 가져오기(v0.2)

### 6.2 제외

1. 멀티유저 인증/권한
2. 추천 알고리즘
3. 읽음/북마크 고급 기능
4. 고가용성 분산 아키텍처

## 7. 요구사항

### 7.1 기능 요구사항

1. 웹 홈 화면에서 소스 등록/수동 동기화 가능해야 한다.
2. API는 `sources`, `items`, `sync`를 JSON으로 제공해야 한다.
3. scheduler는 내부 sync 엔드포인트를 주기 호출해야 한다.
4. 오류는 사용자에게 상태 메시지로 드러나야 한다.

### 7.2 비기능 요구사항

1. 프론트엔드는 RSC를 사용해야 한다.
2. 로컬 최소 실행은 1명 기준 5분 내 기동 가능해야 한다.
3. 캐시 정책은 Cloudflare Edge에 적용 가능해야 한다.
4. 장애 시 프로세스 재기동만으로 복구 가능해야 한다.

## 8. 아키텍처

1. `apps/web`
   - Vite + React Router v7 Framework + RSC
   - 사용자 입력/피드 렌더링
2. `backend/packages/api`
   - REST API + JSON 파일 저장소
3. `backend/packages/scheduler`
   - cron 트리거 + 내부 sync 호출
4. `backend/packages/rss-parser`
   - RSS 파싱/정규화 공통 레이어
5. `apps/extension`
   - 새 탭 진입점(선택)

## 9. API 계약 (MVP)

1. `GET /health`
2. `GET /v1/sources`
3. `POST /v1/sources`
   - body: `{ "url": "https://example.com/rss.xml" }`
4. `GET /v1/items?limit=50&offset=0`
5. `POST /v1/sync`
   - body(optional): `{ "sourceId": 1 }`
6. `POST /internal/sync`
   - header: `x-scheduler-key` (설정된 경우 필수)

## 10. 성공 지표 (MVP)

1. 일별 개인 사용 가능 여부: `GET /` 성공률 99%+
2. 동기화 성공률: 등록 소스 기준 95%+
3. 최신 반영 지연: 평균 30분 이내
4. 운영 단순성: 로컬 기동/검증 명령 2개 이내

## 11. 로컬 검증 시나리오 (정상동작 판정용)

### 시나리오 A: 최소 정상동작

1. `yarn dev:local`
2. `curl http://localhost:4000/health` -> `200` + `{"ok":true,...}`
3. `curl http://localhost:5173/` -> `200`
4. 응답 HTML에 `fetch failed`/`Network connection lost`가 없어야 함

### 시나리오 B: 스모크 자동검증

1. `yarn smoke:local`
2. `[smoke] PASS` 출력 시 정상

## 12. 단계별 구현 계획

### Phase 1 (지금)

1. 핵심 유저 스토리 정상동작 고정
2. 로컬 최소 정상동작 자동검증 유지
3. 수동 동기화까지 사용자 플로우 완결

### Phase 2

1. 자동 동기화 안정성(재시도/로그) 강화
2. 소스/아이템 필터링(개인 사용성 개선)

### Phase 3

1. 읽음/즐겨찾기
2. 백업/내보내기

## 13. 오픈 이슈

1. 동기화 실패 로그 저장 위치와 보존 정책
2. 캐시 무효화 전략(수동 sync 직후 반영 지연 최소화)
3. 새 탭 extension을 MVP에 포함할지 여부
